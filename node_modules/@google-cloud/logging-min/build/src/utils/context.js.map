{"version":3,"sources":["../../../src/utils/context.ts"],"names":["uuid","require","crypto","exports","X_CLOUD_TRACE_HEADER","SPAN_ID_RANDOM_BYTES","spanIdBuffer","Buffer","alloc","randomFillSync","randomBytes","spanRandomBuffer","W3C_TRACE_PARENT_HEADER","makeHeaderWrapper","req","headers","wrapper","setHeader","name","value","getHeader","getOrInjectContext","projectId","inject","defaultContext","toCloudTraceContext","traceContext","getContextFromTraceParent","cloudContext","getContextFromXCloudTrace","makeCloudTraceHeader","anyContext","context","trace","spanId","traceSampled","v4","replace","toString","headerWrapper","parseXCloudTraceHeader","parseTraceParentHeader","regex","match","_a","VERSION_PART","TRACE_ID_PART","PARENT_ID_PART","FLAGS_PART","TRACE_PARENT_REGEX","RegExp","parseInt"],"mappings":"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"}